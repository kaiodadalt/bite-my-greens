#!/bin/sh

echo "Running pre-commit tests..."

# Navigate to the root directory of the repository
cd "$(git rev-parse --show-toplevel)" || exit 1

if [ -f "vendor/bin/sail" ]; then
    echo "Detected vendor/bin/sail. Running tests with Sail..."
    ./vendor/bin/sail composer test
else
    echo "Sail not found. Running tests with Composer..."
    composer test
fi

# Check the exit code of the test command
if [ $? -ne 0 ]; then
    echo "Tests failed. Aborting commit."
    exit 1
fi

echo "Tests passed. Proceeding with commit."
exit 0
